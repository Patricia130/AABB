workflows:
  android-native-release:
    name: To Chegando Cliente - Build Release
    instance_type: mac_mini_m1
    max_build_duration: 60
    environment:
      vars:
        GRADLE_OPTS: "-Xmx4096m"
      java: 17
      android:
        sdk: 34

    scripts:
      - name: ğŸ” Localizar gradlew automaticamente
        script: |
          echo "ğŸ” Procurando o gradlew..."
          GRADLEW_PATH=$(find . -type f -name "gradlew" | head -n 1)
          echo "âœ… Encontrado em: $GRADLEW_PATH"
          chmod +x "$GRADLEW_PATH"

      - name: ğŸ§¹ Limpar projeto
        script: |
          echo "ğŸ§¹ Executando clean..."
          $GRADLEW_PATH clean

      - name: ğŸ“¦ Build Release APK
        script: |
          echo "âš™ï¸ Gerando APK de release..."
          $GRADLEW_PATH assembleRelease

      - name: ğŸ“¦ Build Release AAB
        script: |
          echo "âš™ï¸ Gerando AAB de release..."
          $GRADLEW_PATH bundleRelease

    artifacts:
      - app/build/outputs/apk/release/*.apk
      - app/build/outputs/bundle/release/*.aab

    publishing:
      email:
        recipients:
          - seuemail@dominio.com
        notify:
          success: true
          failure: true
